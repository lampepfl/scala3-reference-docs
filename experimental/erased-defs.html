<html><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><title>Erased Definitions</title><link rel="shortcut icon" type="image/x-icon" href="../favicon.ico"></link><script type="text/javascript" src="../scripts/theme.js"></script><link rel="stylesheet" href="../css/bootstrap.min.css"></link><link rel="stylesheet" href="../css/dottydoc.css"></link><link rel="stylesheet" href="../css/color-brewer.css"></link><script type="text/javascript" src="../js/jquery.min.js" defer="true"></script><script type="text/javascript" src="../js/bootstrap.min.js" defer="true"></script><link rel="stylesheet" href="../css/content-contributors.css"></link><script type="text/javascript" src="../js/contributors.js" defer="true"></script><script type="text/javascript" src="../scripts/searchData.js" defer="true"></script><script type="text/javascript" src="../scripts/scastieConfiguration.js" defer="true"></script><link rel="stylesheet" href="../styles/nord-light.css"></link><link rel="stylesheet" href="../styles/scalastyle.css"></link><link rel="stylesheet" href="../styles/colors.css"></link><link rel="stylesheet" href="../styles/dotty-icons.css"></link><link rel="stylesheet" href="../styles/diagram.css"></link><link rel="stylesheet" href="../styles/filter-bar.css"></link><link rel="stylesheet" href="../styles/code-snippets.css"></link><link rel="stylesheet" href="../styles/searchbar.css"></link><link rel="stylesheet" href="../styles/social-links.css"></link><link rel="stylesheet" href="../styles/ux.css"></link><link rel="stylesheet" href="../styles/versions-dropdown.css"></link><link rel="stylesheet" href="../styles/fontawesome.css"></link><script type="text/javascript" src="../hljs/highlight.min.js" defer="true"></script><script type="text/javascript" src="../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../scripts/scaladoc-scalajs.js" defer="true"></script><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><script type="text/javascript" src="https://scastie.scala-lang.org/embedded.js" defer="true"></script><script type="text/javascript" src="../scripts/data.js" defer="true"></script><script>var pathToRoot = "../";</script><script>var githubContributorsUrl = "https://api.github.com/repos/lampepfl/dotty";</script><script>var githubContributorsFilename = "docs/_docs/reference/experimental/erased-defs.md";</script></head><body><div id="container"><div id="leftColumn"><div id="logo"><span><img src="../project-logo/logo.svg"></img></span><span><div class="projectName">Scala 3 Reference</div></span><div id="version"><div class="versions-dropdown"><div onclick="dropdownHandler()" id="dropdown-button" class="dropdownbtn dropdownbtnactive"><div class="projectVersion">3.1.2</div><div id="dropdown-content" class="dropdown-content"><input type="text" placeholder="Search..." id="dropdown-input" onkeyup="filterFunction()"></input></div></div></div></div><div class="socials"><a href="https://github.com/lampepfl/dotty"><span class="social-icon" data-icon-path="github-icon-white.png"></span></a><a href="https://discord.com/invite/scala"><span class="social-icon" data-icon-path="discord-icon-white.png"></span></a><a href="https://twitter.com/scala_lang"><span class="social-icon" data-icon-path="twitter-icon-white.png"></span></a></div></div><div id="paneSearch"></div><nav id="sideMenu2"><div class="ni expanded"><span class="nh expanded"><span class="ar"></span><a href="../index.html"><span>Scala 3 Reference</span></a></span><div class="ni"><span class="nh "><span class="ar"></span><a href="../new-types/index.html"><span>New Types</span></a></span><div class="ni "><span class="nh "><a href="../new-types/intersection-types.html"><span>Intersection Types</span></a></span></div><div class="ni "><span class="nh "><a href="../new-types/union-types.html"><span>Union Types</span></a></span></div><div class="ni "><span class="nh "><a href="../new-types/type-lambdas.html"><span>Type Lambdas</span></a></span></div><div class="ni "><span class="nh "><a href="../new-types/match-types.html"><span>Match Types</span></a></span></div><div class="ni "><span class="nh "><a href="../new-types/dependent-function-types.html"><span>Dependent Function Types</span></a></span></div><div class="ni "><span class="nh "><a href="../new-types/polymorphic-function-types.html"><span>Polymorphic Function Types</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../enums/index.html"><span>Enums</span></a></span><div class="ni "><span class="nh "><a href="../enums/enums.html"><span>Enumerations</span></a></span></div><div class="ni "><span class="nh "><a href="../enums/adts.html"><span>Algebraic Data Types</span></a></span></div><div class="ni "><span class="nh "><a href="../enums/desugarEnums.html"><span>Translation of Enums and ADTs</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../contextual/index.html"><span>Contextual Abstractions</span></a></span><div class="ni "><span class="nh "><a href="../contextual/givens.html"><span>Given Instances</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/using-clauses.html"><span>Using Clauses</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/context-bounds.html"><span>Context Bounds</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/given-imports.html"><span>Importing Givens</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/extension-methods.html"><span>Extension Methods</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/right-associative-extension-methods.html"><span>Right-Associative Extension Methods: Details</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/type-classes.html"><span>Implementing Type classes</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/derivation.html"><span>Type Class Derivation</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/derivation-macro.html"><span>How to write a type class `derived` method using macros</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/multiversal-equality.html"><span>Multiversal Equality</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/context-functions.html"><span>Context Functions</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/conversions.html"><span>Implicit Conversions</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/by-name-context-parameters.html"><span>By-Name Context Parameters</span></a></span></div><div class="ni "><span class="nh "><a href="../contextual/relationship-implicits.html"><span>Relationship with Scala 2 Implicits</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../metaprogramming/index.html"><span>Metaprogramming</span></a></span><div class="ni "><span class="nh "><a href="../metaprogramming/inline.html"><span>Inline</span></a></span></div><div class="ni "><span class="nh "><a href="../metaprogramming/compiletime-ops.html"><span>Compile-time operations</span></a></span></div><div class="ni "><span class="nh "><a href="../metaprogramming/macros.html"><span>Macros</span></a></span></div><div class="ni "><span class="nh "><a href="../metaprogramming/staging.html"><span>Runtime Multi-Stage Programming</span></a></span></div><div class="ni "><span class="nh "><a href="../metaprogramming/reflection.html"><span>Reflection</span></a></span></div><div class="ni "><span class="nh "><a href="../metaprogramming/tasty-inspect.html"><span>TASTy Inspection</span></a></span></div><div class="ni "><span class="nh "><a href="../metaprogramming/simple-smp.html"><span>The Meta-theory of Symmetric Metaprogramming</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../other-new-features/index.html"><span>Other New Features</span></a></span><div class="ni "><span class="nh "><a href="../other-new-features/trait-parameters.html"><span>Trait Parameters</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/transparent-traits.html"><span>Transparent Traits</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/creator-applications.html"><span>Universal Apply Methods</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/export.html"><span>Export Clauses</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/opaques.html"><span>Opaque Type Aliases</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/opaques-details.html"><span>Opaque Type Aliases: More Details</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/open-classes.html"><span>Open Classes</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/parameter-untupling.html"><span>Parameter Untupling</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/kind-polymorphism.html"><span>Kind Polymorphism</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/matchable.html"><span>The Matchable Trait</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/threadUnsafe-annotation.html"><span>The @threadUnsafe annotation</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/targetName.html"><span>The @targetName annotation</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/control-syntax.html"><span>New Control Syntax</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/indentation.html"><span>Optional Braces</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/safe-initialization.html"><span>Safe Initialization</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/type-test.html"><span>TypeTest</span></a></span></div><div class="ni "><span class="nh "><a href="../other-new-features/experimental-defs.html"><span>Experimental Definitions</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../changed-features/index.html"><span>Other Changed Features</span></a></span><div class="ni "><span class="nh "><a href="../changed-features/numeric-literals.html"><span>Numeric Literals</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/structural-types.html"><span>Programmatic Structural Types</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/operators.html"><span>Rules for Operators</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/wildcards.html"><span>Wildcard Arguments in Types</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/imports.html"><span>Imports</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/type-checking.html"><span>Changes in Type Checking</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/type-inference.html"><span>Changes in Type Inference</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/implicit-resolution.html"><span>Changes in Implicit Resolution</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/implicit-conversions.html"><span>Implicit Conversions</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/overload-resolution.html"><span>Changes in Overload Resolution</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/match-syntax.html"><span>Match Expressions</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/vararg-splices.html"><span>Vararg Splices</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/pattern-bindings.html"><span>Pattern Bindings</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/pattern-matching.html"><span>Option-less pattern matching</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/eta-expansion.html"><span>Automatic Eta Expansion</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/compiler-plugins.html"><span>Changes in Compiler Plugins</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/lazy-vals-init.html"><span>Lazy Vals Initialization</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/main-functions.html"><span>Main Methods</span></a></span></div><div class="ni "><span class="nh "><a href="../changed-features/interpolation-escapes.html"><span>Escapes in interpolations</span></a></span></div></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../dropped-features/index.html"><span>Dropped Features</span></a></span><div class="ni "><span class="nh "><a href="../dropped-features/delayed-init.html"><span>Dropped: DelayedInit</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/macros.html"><span>Dropped: Scala 2 Macros</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/existential-types.html"><span>Dropped: Existential Types</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/type-projection.html"><span>Dropped: General Type Projection</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/do-while.html"><span>Dropped: Do-While</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/procedure-syntax.html"><span>Dropped: Procedure Syntax</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/package-objects.html"><span>Dropped: Package Objects</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/early-initializers.html"><span>Dropped: Early Initializers</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/class-shadowing.html"><span>Dropped: Class Shadowing</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/limit22.html"><span>Dropped: Limit 22</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/xml.html"><span>Dropped: XML Literals</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/symlits.html"><span>Dropped: Symbol Literals</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/auto-apply.html"><span>Dropped: Auto-Application</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/weak-conformance.html"><span>Dropped: Weak Conformance</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/nonlocal-returns.html"><span>Deprecated: Nonlocal Returns</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/this-qualifier.html"><span>Dropped: private[this] and protected[this]</span></a></span></div><div class="ni "><span class="nh "><a href="../dropped-features/wildcard-init.html"><span>Dropped: Wildcard Initializer</span></a></span></div></div><div class="ni expanded"><span class="nh expanded"><span class="ar"></span><a href="index.html"><span>Experimental</span></a></span><div class="ni "><span class="nh "><a href="fewer-braces.html"><span>Fewer Braces</span></a></span></div><div class="ni "><span class="nh "><a href="canthrow.html"><span>CanThrow Capabilities</span></a></span></div><div class="ni expanded"><span class="nh selected"><a href="erased-defs.html"><span>Erased Definitions</span></a></span></div><div class="ni "><span class="nh "><a href="named-typeargs.html"><span>Named Type Arguments</span></a></span></div><div class="ni "><span class="nh "><a href="numeric-literals.html"><span>Numeric Literals</span></a></span></div><div class="ni "><span class="nh "><a href="explicit-nulls.html"><span>Explicit Nulls</span></a></span></div><div class="ni "><span class="nh "><a href="main-annotation.html"><span>MainAnnotation</span></a></span></div><div class="ni "><span class="nh "><a href="cc.html"><span>Capture Checking</span></a></span></div><div class="ni "><span class="nh "><a href="tupled-function.html"><span>Tupled Function</span></a></span></div></div><div class="ni "><span class="nh "><a href="../syntax.html"><span>Scala 3 Syntax Summary</span></a></span></div><div class="ni"><span class="nh "><span class="ar"></span><a href="../language-versions/index.html"><span>Language Versions</span></a></span><div class="ni "><span class="nh "><a href="../language-versions/source-compatibility.html"><span>Source Compatibility</span></a></span></div><div class="ni "><span class="nh "><a href="../language-versions/binary-compatibility.html"><span>Binary Compatibility</span></a></span></div></div><div class="ni "><span class="nh "><a href="../soft-modifier.html"><span>Soft Keywords</span></a></span></div><div class="ni "><span class="nh "><a href="../features-classification.html"><span>A Classification of Proposed Language Features</span></a></span></div></div></nav></div><div id="main"><div id="leftToggler"><span class="icon-toggler"></span></div><div id="scaladoc-searchBar"></div><main id="main-content"><div class="breadcrumbs container"><a href="../index.html">Scala 3 Reference</a>/<a href="index.html">Experimental</a>/<a href="erased-defs.html">Erased Definitions</a></div><div id="content"><html>
 <head>
  <link rel="dns-prefetch" href="//fonts.googleapis.com"> 
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css"> 
 </head>
 <body>
  <div id="content-wrapper"> 
   <div class="container"> 
    <div id="site-header"> 
     <div class="wrap"> 
      <nav class="navigation" role="menu"> 
       <ul class="navigation-menu"> 
        <li class="navigation-menu-item"> <a href="https://docs.scala-lang.org/" class="active">Learn</a> </li> 
        <li class="navigation-menu-item"> <a href="https://www.scala-lang.org/download/">Install</a> </li> 
        <li class="navigation-menu-item"> <a href="https://scastie.scala-lang.org">Playground</a> </li> 
        <li class="navigation-menu-item"> <a href="https://index.scala-lang.org">Find A Library</a> </li> 
        <li class="navigation-menu-item"> <a href="https://www.scala-lang.org/community/">Community</a> </li> 
        <li class="navigation-menu-item"> <a href="https://www.scala-lang.org/blog/">Blog</a> </li> 
       </ul> 
      </nav> 
     </div> 
    </div> 
    <main> 
     <header> 
      <h1>Erased Definitions</h1> 
      <div class="byline"> <a href="https://github.com/lampepfl/dotty/edit/language-reference-stable/docs/_docs/reference/experimental/erased-defs.md"> <i class="far fa-edit"></i> Edit this page on GitHub </a> 
      </div> 
     </header> 
     <p><code>erased</code> is a modifier that expresses that some definition or expression is erased by the compiler instead of being represented in the compiled output. It is not yet part of the Scala language standard. To enable <code>erased</code>, turn on the language feature <a href="https://scala-lang.org/api/3.x/scala/runtime/stdLibPatches/language$$experimental$$erasedDefinitions$.html"><code>experimental.erasedDefinitions</code></a>. This can be done with a language import</p> 
     <div class="snippet" scala-snippet="">
      <div class="buttons"></div>
      <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import scala.language.experimental.erasedDefinitions
</span></code></pre>
     </div> 
     <p>or by setting the command line option <code>-language:experimental.erasedDefinitions</code>. Erased definitions must be in an experimental scope (see <a href="../other-new-features/experimental-defs.html">Experimental definitions</a>).</p> 
     <section id="why-erased-terms"> 
      <h2><a href="#why-erased-terms" class="anchor"></a>Why erased terms?</h2> 
      <p>Let's describe the motivation behind erased terms with an example. In the following we show a simple state machine which can be in a state <code>On</code> or <code>Off</code>. The machine can change state from <code>Off</code> to <code>On</code> with <code>turnedOn</code> only if it is currently <code>Off</code>. This last constraint is captured with the <code>IsOff[S]</code> contextual evidence which only exists for <code>IsOff[Off]</code>. For example, not allowing calling <code>turnedOn</code> on in an <code>On</code> state as we would require an evidence of type <code>IsOff[On]</code> that will not be found.</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>sealed trait State
</span><span id="1" class=""><span class="tooltip-container"></span>final class On extends State
</span><span id="2" class=""><span class="tooltip-container"></span>final class Off extends State
</span><span id="3" class=""><span class="tooltip-container"></span>
</span><span id="4" class=""><span class="tooltip-container"></span>@implicitNotFound("State must be Off")
</span><span id="5" class=""><span class="tooltip-container"></span>class IsOff[S &lt;: State]
</span><span id="6" class=""><span class="tooltip-container"></span>object IsOff:
</span><span id="7" class=""><span class="tooltip-container"></span>  given isOff: IsOff[Off] = new IsOff[Off]
</span><span id="8" class=""><span class="tooltip-container"></span>
</span><span id="9" class=""><span class="tooltip-container"></span>class Machine[S &lt;: State]:
</span><span id="10" class=""><span class="tooltip-container"></span>  def turnedOn(using IsOff[S]): Machine[On] = new Machine[On]
</span><span id="11" class=""><span class="tooltip-container"></span>
</span><span id="12" class=""><span class="tooltip-container"></span>val m = new Machine[Off]
</span><span id="13" class=""><span class="tooltip-container"></span>m.turnedOn
</span><span id="14" class=""><span class="tooltip-container"></span>m.turnedOn.turnedOn // ERROR
</span><span id="15" class=""><span class="tooltip-container"></span>//                 ^
</span><span id="16" class=""><span class="tooltip-container"></span>//                  State must be Off
</span></code></pre>
      </div> 
      <p>Note that in the code above the actual context arguments for <code>IsOff</code> are never used at runtime; they serve only to establish the right constraints at compile time. As these terms are never used at runtime there is not real need to have them around, but they still need to be present in some form in the generated code to be able to do separate compilation and retain binary compatibility. We introduce <em>erased terms</em> to overcome this limitation: we are able to enforce the right constrains on terms at compile time. These terms have no run time semantics and they are completely erased.</p> 
     </section>
     <section id="how-to-define-erased-terms"> 
      <h2><a href="#how-to-define-erased-terms" class="anchor"></a>How to define erased terms?</h2> 
      <p>Parameters of methods and functions can be declared as erased, placing <code>erased</code> in front of a parameter list (like <code>given</code>).</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>def methodWithErasedEv(erased ev: Ev): Int = 42
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val lambdaWithErasedEv: erased Ev =&gt; Int =
</span><span id="3" class=""><span class="tooltip-container"></span>  (erased ev: Ev) =&gt; 42
</span></code></pre>
      </div> 
      <p><code>erased</code> parameters will not be usable for computations, though they can be used as arguments to other <code>erased</code> parameters.</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>def methodWithErasedInt1(erased i: Int): Int =
</span><span id="1" class=""><span class="tooltip-container"></span>  i + 42 // ERROR: can not use i
</span><span id="2" class=""><span class="tooltip-container"></span>
</span><span id="3" class=""><span class="tooltip-container"></span>def methodWithErasedInt2(erased i: Int): Int =
</span><span id="4" class=""><span class="tooltip-container"></span>  methodWithErasedInt1(i) // OK
</span></code></pre>
      </div> 
      <p>Not only parameters can be marked as erased, <code>val</code> and <code>def</code> can also be marked with <code>erased</code>. These will also only be usable as arguments to <code>erased</code> parameters.</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>erased val erasedEvidence: Ev = ...
</span><span id="1" class=""><span class="tooltip-container"></span>methodWithErasedEv(erasedEvidence)
</span></code></pre>
      </div>
     </section>
     <section id="what-happens-with-erased-values-at-runtime"> 
      <h2><a href="#what-happens-with-erased-values-at-runtime" class="anchor"></a>What happens with erased values at runtime?</h2> 
      <p>As <code>erased</code> are guaranteed not to be used in computations, they can and will be erased.</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>// becomes def methodWithErasedEv(): Int at runtime
</span><span id="1" class=""><span class="tooltip-container"></span>def methodWithErasedEv(erased ev: Ev): Int = ...
</span><span id="2" class=""><span class="tooltip-container"></span>
</span><span id="3" class=""><span class="tooltip-container"></span>def evidence1: Ev = ...
</span><span id="4" class=""><span class="tooltip-container"></span>erased def erasedEvidence2: Ev = ... // does not exist at runtime
</span><span id="5" class=""><span class="tooltip-container"></span>erased val erasedEvidence3: Ev = ... // does not exist at runtime
</span><span id="6" class=""><span class="tooltip-container"></span>
</span><span id="7" class=""><span class="tooltip-container"></span>// evidence1 is not evaluated and no value is passed to methodWithErasedEv
</span><span id="8" class=""><span class="tooltip-container"></span>methodWithErasedEv(evidence1)
</span></code></pre>
      </div>
     </section>
     <section id="state-machine-with-erased-evidence-example"> 
      <h2><a href="#state-machine-with-erased-evidence-example" class="anchor"></a>State machine with erased evidence example</h2> 
      <p>The following example is an extended implementation of a simple state machine which can be in a state <code>On</code> or <code>Off</code>. The machine can change state from <code>Off</code> to <code>On</code> with <code>turnedOn</code> only if it is currently <code>Off</code>, conversely from <code>On</code> to <code>Off</code> with <code>turnedOff</code> only if it is currently <code>On</code>. These last constraint are captured with the <code>IsOff[S]</code> and <code>IsOn[S]</code> given evidence only exist for <code>IsOff[Off]</code> and <code>IsOn[On]</code>. For example, not allowing calling <code>turnedOff</code> on in an <code>Off</code> state as we would require an evidence <code>IsOn[Off]</code> that will not be found.</p> 
      <p>As the given evidences of <code>turnedOn</code> and <code>turnedOff</code> are not used in the bodies of those functions we can mark them as <code>erased</code>. This will remove the evidence parameters at runtime, but we would still evaluate the <code>isOn</code> and <code>isOff</code> givens that were found as arguments. As <code>isOn</code> and <code>isOff</code> are not used except as <code>erased</code> arguments, we can mark them as <code>erased</code>, hence removing the evaluation of the <code>isOn</code> and <code>isOff</code> evidences.</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import scala.annotation.implicitNotFound
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>sealed trait State
</span><span id="3" class=""><span class="tooltip-container"></span>final class On extends State
</span><span id="4" class=""><span class="tooltip-container"></span>final class Off extends State
</span><span id="5" class=""><span class="tooltip-container"></span>
</span><span id="6" class=""><span class="tooltip-container"></span>@implicitNotFound("State must be Off")
</span><span id="7" class=""><span class="tooltip-container"></span>class IsOff[S &lt;: State]
</span><span id="8" class=""><span class="tooltip-container"></span>object IsOff:
</span><span id="9" class=""><span class="tooltip-container"></span>  // will not be called at runtime for turnedOn, the
</span><span id="10" class=""><span class="tooltip-container"></span>  // compiler will only require that this evidence exists
</span><span id="11" class=""><span class="tooltip-container"></span>  given IsOff[Off] = new IsOff[Off]
</span><span id="12" class=""><span class="tooltip-container"></span>
</span><span id="13" class=""><span class="tooltip-container"></span>@implicitNotFound("State must be On")
</span><span id="14" class=""><span class="tooltip-container"></span>class IsOn[S &lt;: State]
</span><span id="15" class=""><span class="tooltip-container"></span>object IsOn:
</span><span id="16" class=""><span class="tooltip-container"></span>  // will not exist at runtime, the compiler will only
</span><span id="17" class=""><span class="tooltip-container"></span>  // require that this evidence exists at compile time
</span><span id="18" class=""><span class="tooltip-container"></span>  erased given IsOn[On] = new IsOn[On]
</span><span id="19" class=""><span class="tooltip-container"></span>
</span><span id="20" class=""><span class="tooltip-container"></span>class Machine[S &lt;: State] private ():
</span><span id="21" class=""><span class="tooltip-container"></span>  // ev will disappear from both functions
</span><span id="22" class=""><span class="tooltip-container"></span>  def turnedOn(using erased ev: IsOff[S]): Machine[On] = new Machine[On]
</span><span id="23" class=""><span class="tooltip-container"></span>  def turnedOff(using erased ev: IsOn[S]): Machine[Off] = new Machine[Off]
</span><span id="24" class=""><span class="tooltip-container"></span>
</span><span id="25" class=""><span class="tooltip-container"></span>object Machine:
</span><span id="26" class=""><span class="tooltip-container"></span>  def newMachine(): Machine[Off] = new Machine[Off]
</span><span id="27" class=""><span class="tooltip-container"></span>
</span><span id="28" class=""><span class="tooltip-container"></span>@main def test =
</span><span id="29" class=""><span class="tooltip-container"></span>  val m = Machine.newMachine()
</span><span id="30" class=""><span class="tooltip-container"></span>  m.turnedOn
</span><span id="31" class=""><span class="tooltip-container"></span>  m.turnedOn.turnedOff
</span><span id="32" class=""><span class="tooltip-container"></span>
</span><span id="33" class=""><span class="tooltip-container"></span>  // m.turnedOff
</span><span id="34" class=""><span class="tooltip-container"></span>  //            ^
</span><span id="35" class=""><span class="tooltip-container"></span>  //            State must be On
</span><span id="36" class=""><span class="tooltip-container"></span>
</span><span id="37" class=""><span class="tooltip-container"></span>  // m.turnedOn.turnedOn
</span><span id="38" class=""><span class="tooltip-container"></span>  //                    ^
</span><span id="39" class=""><span class="tooltip-container"></span>  //                    State must be Off
</span></code></pre>
      </div> 
      <p>Note that in <a href="../metaprogramming/inline.html">Inline</a> we discussed <code>erasedValue</code> and inline matches. <code>erasedValue</code> is implemented with <code>erased</code>, so the state machine above can be encoded as follows:</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>import scala.compiletime.*
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>sealed trait State
</span><span id="3" class=""><span class="tooltip-container"></span>final class On extends State
</span><span id="4" class=""><span class="tooltip-container"></span>final class Off extends State
</span><span id="5" class=""><span class="tooltip-container"></span>
</span><span id="6" class=""><span class="tooltip-container"></span>class Machine[S &lt;: State]:
</span><span id="7" class=""><span class="tooltip-container"></span>  transparent inline def turnOn(): Machine[On] =
</span><span id="8" class=""><span class="tooltip-container"></span>    inline erasedValue[S] match
</span><span id="9" class=""><span class="tooltip-container"></span>      case _: Off =&gt; new Machine[On]
</span><span id="10" class=""><span class="tooltip-container"></span>      case _: On  =&gt; error("Turning on an already turned on machine")
</span><span id="11" class=""><span class="tooltip-container"></span>
</span><span id="12" class=""><span class="tooltip-container"></span>  transparent inline def turnOff(): Machine[Off] =
</span><span id="13" class=""><span class="tooltip-container"></span>    inline erasedValue[S] match
</span><span id="14" class=""><span class="tooltip-container"></span>      case _: On  =&gt; new Machine[Off]
</span><span id="15" class=""><span class="tooltip-container"></span>      case _: Off =&gt; error("Turning off an already turned off machine")
</span><span id="16" class=""><span class="tooltip-container"></span>
</span><span id="17" class=""><span class="tooltip-container"></span>object Machine:
</span><span id="18" class=""><span class="tooltip-container"></span>  def newMachine(): Machine[Off] =
</span><span id="19" class=""><span class="tooltip-container"></span>    println("newMachine")
</span><span id="20" class=""><span class="tooltip-container"></span>    new Machine[Off]
</span><span id="21" class=""><span class="tooltip-container"></span>end Machine
</span><span id="22" class=""><span class="tooltip-container"></span>
</span><span id="23" class=""><span class="tooltip-container"></span>@main def test =
</span><span id="24" class=""><span class="tooltip-container"></span>  val m = Machine.newMachine()
</span><span id="25" class=""><span class="tooltip-container"></span>  m.turnOn()
</span><span id="26" class=""><span class="tooltip-container"></span>  m.turnOn().turnOff()
</span><span id="27" class=""><span class="tooltip-container"></span>  m.turnOn().turnOn() // error: Turning on an already turned on machine
</span></code></pre>
      </div>
     </section>
     <section id="erased-classes"> 
      <h2><a href="#erased-classes" class="anchor"></a>Erased Classes</h2> 
      <p><code>erased</code> can also be used as a modifier for a class. An erased class is intended to be used only in erased definitions. If the type of a val definition or parameter is a (possibly aliased, refined, or instantiated) erased class, the definition is assumed to be <code>erased</code> itself. Likewise, a method with an erased class return type is assumed to be <code>erased</code> itself. Since given instances expand to vals and defs, they are also assumed to be erased if the type they produce is an erased class. Finally function types with erased classes as arguments turn into erased function types.</p> 
      <p>Example:</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>erased class CanRead
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>val x: CanRead = ...        // `x` is turned into an erased val
</span><span id="3" class=""><span class="tooltip-container"></span>val y: CanRead =&gt; Int = ... // the function is turned into an erased function
</span><span id="4" class=""><span class="tooltip-container"></span>def f(x: CanRead) = ...     // `f` takes an erased parameter
</span><span id="5" class=""><span class="tooltip-container"></span>def g(): CanRead = ...      // `g` is turned into an erased def
</span><span id="6" class=""><span class="tooltip-container"></span>given CanRead = ...         // the anonymous given is assumed to be erased
</span></code></pre>
      </div> 
      <p>The code above expands to</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>erased class CanRead
</span><span id="1" class=""><span class="tooltip-container"></span>
</span><span id="2" class=""><span class="tooltip-container"></span>erased val x: CanRead = ...
</span><span id="3" class=""><span class="tooltip-container"></span>val y: (erased CanRead) =&gt; Int = ...
</span><span id="4" class=""><span class="tooltip-container"></span>def f(erased x: CanRead) = ...
</span><span id="5" class=""><span class="tooltip-container"></span>erased def g(): CanRead = ...
</span><span id="6" class=""><span class="tooltip-container"></span>erased given CanRead = ...
</span></code></pre>
      </div> 
      <p>After erasure, it is checked that no references to values of erased classes remain and that no instances of erased classes are created. So the following would be an error:</p> 
      <div class="snippet" scala-snippet="">
       <div class="buttons"></div>
       <pre><code class="language-scala"><span id="0" class=""><span class="tooltip-container"></span>val err: Any = CanRead() // error: illegal reference to erased class CanRead
</span></code></pre>
      </div> 
      <p>Here, the type of <code>err</code> is <code>Any</code>, so <code>err</code> is not considered erased. Yet its initializing value is a reference to the erased class <code>CanRead</code>.</p> 
      <p><a href="erased-defs-spec.html">More Details</a></p> 
     </section> 
    </main> 
    <nav class="arrows-wrapper" aria-label="Page navigation"> <a rel="prev" href="canthrow.html" class="arrows previous" aria-keyshortcuts="Left"> <span>CanThrow Capabilities</span> <i class="fa fa-angle-left"></i> </a> <a rel="next" href="erased-defs-spec.html" class="arrows next" aria-keyshortcuts="Right"> <span>Erased Definitions - More Details</span> <i class="fa fa-angle-right"></i> </a> 
    </nav> 
    <div class="content-contributors hidden"> <span><b>Contributors to this page</b></span> 
     <div id="documentation-contributors" class="contributors-container"></div> 
    </div> 
   </div> 
  </div>
 </body>
</html></div></main><footer><div id="generated-by"><span class="footer-text">Generated by</span><a href="https://github.com/lampepfl/dotty/tree/main/scaladoc"><img src="../images/scaladoc_logo.svg" alt="scaladoc" class="scaladoc_logo"></img><img src="../images/scaladoc_logo_dark.svg" alt="scaladoc" class="scaladoc_logo_dark"></img></a></div><span id="footer-text">Copyright (c) 2002-2022, LAMP/EPFL</span><div class="socials"><span class="footer-text">Social links</span><a href="https://github.com/lampepfl/dotty"><span class="social-icon" data-icon-path="github-icon-black.png"></span></a><a href="https://discord.com/invite/scala"><span class="social-icon" data-icon-path="discord-icon-black.png"></span></a><a href="https://twitter.com/scala_lang"><span class="social-icon" data-icon-path="twitter-icon-black.png"></span></a></div><div class="mode"><span class="footer-text">Mode</span><label id="theme-toggle" class="switch"><input type="checkbox"></input><span class="slider"></span></label></div><span class="go-to-top-icon"><a href="#container"><span class="icon-vertical_align_top"></span><span class="footer-text">Back to top</span></a></span></footer></div><div id="toc"><span class="toc-title">In this article</span><nav class="toc-nav"><ul class="toc-list"><li><ul><li><a href="#why-erased-terms">Why erased terms?</a></li><li><a href="#how-to-define-erased-terms">How to define erased terms?</a></li><li><a href="#what-happens-with-erased-values-at-runtime">What happens with erased values at runtime?</a></li><li><a href="#state-machine-with-erased-evidence-example">State machine with erased evidence example</a></li><li><a href="#erased-classes">Erased Classes</a></li></ul></li></ul></nav></div></div></body></html>